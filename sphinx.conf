#!/bin/sh
printf "
source repos {
    type = pgsql
    sql_host = postgres
    sql_user = postgres
    sql_pass = $HUBGREP_POSTGRES_PASSWORD
    sql_db = postgres
    sql_port = 5432
    sql_attr_uint = created_at
    sql_attr_uint = updated_at
    sql_attr_uint = pushed_at
    sql_attr_uint = stars_count
    sql_attr_uint = forks_count
    sql_attr_bool = is_archived
    sql_attr_bool = is_disabled
    sql_attr_bool = is_mirror
    sql_query = SELECT id, name, username, description, created_at, updated_at, pushed_at,stars_count, forks_count, is_fork, is_archived, is_disabled, is_mirror FROM repositories
}

index repos {
    source                  = repos
    path                    = /var/lib/sphinx/data/repos_index
    morphology              = stem_en, metaphone
}

indexer {
    mem_limit               = 1024M
}

searchd {
    log                     = /var/log/sphinx.log
    query_log               = /var/log/sphinx-query.log
    pid_file                = /var/run/sphinx.pid
}
"
